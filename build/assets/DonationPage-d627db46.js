import{r as y,j as e,u as A,B as w,k as Y,m as j}from"./index-94338d41.js";import{P as c}from"./index-ea5f350a.js";import{a as P}from"./Config-0cd071a0.js";const q={MTN_MOBILE_MONEY:"13",TELECEL:"6",AIRTELTIGO_MONEY:"7"},f={INITIATE:"initiate",VERIFY:"verify",WAITING:"waiting",SUCCESS:"success"},k=({onSubmit:s,paymentData:r,setPaymentData:a,amount:o,isLoading:t,onCancel:n})=>{const[i,l]=y.useState(""),x=p=>{const h=p.target.value.replace(/[^0-9]/g,"");h.length<=10&&a(b=>({...b,payer:h})),h.length>0?h.length!==10?l("Phone number must be 10 digits"):h.startsWith("0")?/^0[2-9]/.test(h)?l(""):l("Invalid phone number format"):l("Phone number must start with 0"):l("")},g=r.payer.length===10&&r.payer.startsWith("0")&&/^0[2-9]/.test(r.payer);return e.jsxs("div",{className:"p-6 bg-white rounded-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Payment Details"}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay"}),e.jsx("input",{type:"text",value:`GH₵${o}`,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Network"}),e.jsxs("select",{value:r.channel,onChange:p=>a(h=>({...h,channel:p.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select network"}),Object.entries(q).map(([p,h])=>e.jsx("option",{value:h,children:p.replace("_"," ")},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"tel",value:r.payer,onChange:x,className:`w-full p-2 border rounded-md ${i?"border-red-500":"border-gray-300"}`,placeholder:"Enter 10-digit mobile number",maxLength:10,pattern:"0[2-9][0-9]{8}",inputMode:"numeric",required:!0}),i&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format: 0XX XXXXXXX (10 digits)"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:t||!g||!r.channel,className:`flex-1 bg-dark text-white py-2 px-4 rounded-md hover:bg-darkYellow hover:text-dark\r
                      transition-colors disabled:opacity-40 disabled:cursor-not-allowed`,children:t?"Processing...":"Pay Now"}),e.jsx("button",{type:"button",onClick:n,className:"flex-1 border border-dark text-dark py-2 px-4 rounded-md hover:bg-gray-100",children:"Cancel"})]})]})]})};k.propTypes={onSubmit:c.func.isRequired,paymentData:c.shape({amount:c.number.isRequired,payer:c.string.isRequired,channel:c.string.isRequired}).isRequired,setPaymentData:c.func.isRequired,amount:c.number.isRequired,isLoading:c.bool.isRequired,onCancel:c.func.isRequired};const E=({onSubmit:s,verificationData:r,setVerificationData:a,isLoading:o,onCancel:t})=>{y.useEffect(()=>{r!=null&&r.externalRef||(console.error("Missing externalRef in VerificationForm"),t())},[]);const n=i=>{const l=i.target.value.replace(/[^0-9]/g,"").slice(0,6);a(x=>({...x,otpCode:l}))};return e.jsxs("div",{className:"p-6 bg-white rounded-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Enter Verification Code"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please enter the verification code sent to your phone."}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:r.otpCode,onChange:n,className:"w-full p-2 border border-gray-300 rounded-md text-center text-lg",placeholder:"Enter 6-digit code",maxLength:6,pattern:"\\d{6}",inputMode:"numeric",required:!0,disabled:!r.externalRef||o})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:!r.externalRef||o||r.otpCode.length!==6,className:`flex-1 bg-dark text-white py-2 px-4 rounded-md hover:bg-darkYellow hover:text-dark\r
                      transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:o?"Verifying...":"Verify Code"}),e.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-dark text-dark py-2 px-4 rounded-md hover:bg-gray-100",children:"Cancel"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:t,className:"text-dark hover:text-darkYellow text-sm underline",children:"Didn't receive code? Try again"})})]})};E.propTypes={onSubmit:c.func.isRequired,verificationData:c.shape({externalRef:c.string,otpCode:c.string}).isRequired,setVerificationData:c.func.isRequired,isLoading:c.bool.isRequired,onCancel:c.func.isRequired};const S=({onCancel:s})=>{const[r,a]=y.useState(!1),o=1e4;y.useEffect(()=>{const n=setTimeout(()=>{a(!0)},o);return()=>clearTimeout(n)},[]);const t=()=>{window.confirm("Are you sure you want to cancel the payment?")&&s()};return e.jsxs("div",{className:"p-6 bg-white rounded-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-dark mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Waiting for Payment Approval"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Please approve the payment prompt on your phone."}),r?e.jsxs("div",{className:"mt-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-md",children:[e.jsx("p",{className:"font-medium",children:"Taking longer than expected?"}),e.jsx("p",{className:"text-sm mt-1",children:"If you haven't received a prompt or the payment failed, please try again."})]}):e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"This may take a few moments. Please don't close this window."}),e.jsx("button",{onClick:t,className:"mt-4 text-dark hover:text-darkYellow underline",children:"Cancel Payment"})]})};S.propTypes={onCancel:c.func.isRequired};const C=({transactionDetails:s,amount:r,onClose:a})=>{A();const o=()=>{a==null||a();const t="https://delkomcharityfoundation.com/";window.location.href=t};return e.jsxs("div",{className:"p-6 bg-white rounded-lg text-center",children:[e.jsx("div",{className:"text-green-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-green-600",children:"Payment Successful!"}),e.jsxs("div",{className:"text-gray-600 space-y-2 mb-6",children:[e.jsxs("p",{children:["Amount: GH₵",(s==null?void 0:s.amount)||r]}),(s==null?void 0:s.transactionId)&&e.jsxs("p",{children:["Transaction ID: ",s.transactionId]}),(s==null?void 0:s.payer)&&e.jsxs("p",{children:["Phone Number: ",s.payer]})]}),e.jsxs("div",{className:"flex space-x-4 justify-center",children:[e.jsx("button",{onClick:o,className:`bg-dark text-white py-2 px-4 rounded-md \r
                    hover:bg-darkYellow hover:text-dark transition-colors`,children:"Go to Home"}),e.jsx("button",{onClick:a,className:`border border-dark text-dark py-2 px-4 rounded-md \r
                    hover:bg-gray-100 transition-colors`,children:"Stay Here"})]})]})};C.propTypes={transactionDetails:c.shape({amount:c.number,transactionId:c.string,payer:c.string}),amount:c.number.isRequired,onClose:c.func.isRequired};const T={TP15:"Invalid verification code. Please check and try again.",INVALID_OTP_LENGTH:"Please enter a 6-digit verification code.",INVALID_PHONE:"Please enter a valid phone number.",DEFAULT:"An error occurred. Please try again."},V=async s=>{var r,a,o,t;try{const n={amount:parseFloat(s.amount),payer:s.payer.replace(/\s+/g,""),channel:parseInt(s.channel)},i=await P.post("/payment",n),l=((a=(r=i.data)==null?void 0:r.data)==null?void 0:a.externalRef)||((o=i.data)==null?void 0:o.externalRef);if(!l)throw console.error("Payment Response:",i.data),new Error("Payment reference not received from server");return{...i.data,externalRef:l}}catch(n){console.error("Payment initiation error:",n);const i=(t=n.response)==null?void 0:t.data;throw i!=null&&i.errors&&i.errors[0].path==="payer"?new Error("Please enter a valid phone number"):new Error((i==null?void 0:i.message)||T.DEFAULT)}},F=async(s,r)=>{var a,o,t,n,i,l,x,g,p,h,b,v,u;try{if(!s)throw new Error("Payment reference is required");const d={externalRef:String(s).trim(),otpcode:String(r).trim()};return(await P.post("/verify",d)).data}catch(d){throw console.error("Verification error details:",(a=d.response)==null?void 0:a.data),((n=(t=(o=d.response)==null?void 0:o.data)==null?void 0:t.response)==null?void 0:n.code)==="TP13"?new Error("This verification code has expired. Please start a new payment."):((x=(l=(i=d.response)==null?void 0:i.data)==null?void 0:l.response)==null?void 0:x.code)==="TP15"?new Error("Invalid verification code. Please check and try again."):(p=(g=d.response)==null?void 0:g.data)!=null&&p.details?new Error(d.response.data.details):(b=(h=d.response)==null?void 0:h.data)!=null&&b.errors&&d.response.data.errors.find(R=>R.path==="externalRef")?new Error("Payment session expired. Please start a new payment."):new Error(((u=(v=d.response)==null?void 0:v.data)==null?void 0:u.error)||"Verification failed. Please try again.")}},L=async s=>{var r,a,o;try{const t=await P.post("/status",{externalRef:s});console.log("Status Response:",t.data);const n=((r=t.data.data)==null?void 0:r.paymentStatus)==="Successful",i=((a=t.data.data)==null?void 0:a.paymentStatus)==="Pending";return{success:n,pending:i,data:t.data.data,message:t.data.message}}catch(t){const n=(o=t.response)==null?void 0:o.data;return n!=null&&n.data?{success:!1,pending:!1,data:n.data,message:n.message||"Payment check failed"}:{success:!1,pending:!1,data:null,message:T.DEFAULT}}},M=async(s,r=5)=>{let a=0;const o=async()=>{try{if(a>=r)throw new Error("Payment verification timed out. Please check your transaction status later.");const t=await L(s);if(console.log(`Poll attempt ${a+1}/${r}:`,t),t.success)return t;if(!t.pending)throw new Error(t.message||"Payment failed. Please try again.");return a++,await new Promise(n=>setTimeout(n,3e3)),o()}catch(t){if(t.message.includes("timeout"))throw t;if(a<r)return a++,await new Promise(n=>setTimeout(n,3e3)),o();throw new Error("Payment verification failed. Please try again.")}};return o()},G=s=>{const[r,a]=y.useState(f.INITIATE),[o,t]=y.useState(!1),[n,i]=y.useState({amount:s,payer:"",channel:""}),[l,x]=y.useState({externalRef:"",otpCode:""}),[g,p]=y.useState(null);return{step:r,setStep:a,isLoading:o,paymentData:n,setPaymentData:i,verificationData:l,setVerificationData:x,transactionDetails:g,handlePaymentSubmit:async u=>{var d;u.preventDefault(),t(!0);try{const m=await V(n);console.log("Payment initiation response:",m);const N=((d=m.data)==null?void 0:d.externalRef)||m.externalRef;if(!N)throw console.error("Payment Response:",m),new Error("Payment reference not received from server");x({externalRef:N,otpCode:""}),w.success(m.message||"Payment initiated successfully"),a(f.VERIFY)}catch(m){console.error("Payment initiation error:",m),w.error(m.message||"Payment initiation failed"),a(f.INITIATE)}finally{t(!1)}},handleVerification:async u=>{u.preventDefault(),t(!0);try{if(!l.externalRef)throw new Error("Payment reference not found. Please try again");const d=await F(l.externalRef,l.otpCode);w.info("Please approve the payment on your phone"),a(f.WAITING);const m=await M(l.externalRef,5);m.success?(p(m.data),w.success(m.message||"Payment completed successfully!"),a(f.SUCCESS)):(w.error("Payment was not completed. Please try again."),x({externalRef:"",otpCode:""}),a(f.INITIATE))}catch(d){console.error("Verification error:",d);const m=d.message||"Verification failed";w.error(m),m.includes("expired")||m.includes("session")||m.includes("timeout")||m.includes("failed")?(x({externalRef:"",otpCode:""}),a(f.INITIATE)):m.includes("Invalid verification code")?x(N=>({...N,otpCode:""})):a(f.VERIFY)}finally{t(!1)}},handlePaymentFailure:()=>{x({externalRef:"",otpCode:""}),a(f.INITIATE)}}},I=({amount:s,onSuccess:r,onCancel:a})=>{const{step:o,setStep:t,isLoading:n,paymentData:i,setPaymentData:l,verificationData:x,setVerificationData:g,transactionDetails:p,handlePaymentSubmit:h,handleVerification:b}=G(s),v=()=>{t(f.INITIATE),a()},u=()=>{r==null||r(p)};switch(o){case f.VERIFY:return e.jsx(E,{onSubmit:b,verificationData:x,setVerificationData:g,isLoading:n,onCancel:v});case f.WAITING:return e.jsx(S,{onCancel:()=>t(f.INITIATE)});case f.SUCCESS:return e.jsx(C,{transactionDetails:p,amount:s,onClose:u});default:return e.jsx(k,{onSubmit:h,paymentData:i,setPaymentData:l,amount:s,isLoading:n,onCancel:v})}};I.propTypes={amount:c.number.isRequired,onSuccess:c.func,onCancel:c.func.isRequired};const H="/assets/books-9e9fd7f6.jpg",O="/assets/cloths-a372c3b2.jpg",_="/assets/foodd-23cd5805.jpg",D=()=>{const[s,r]=y.useState(!1),[a,o]=y.useState(null),[t,n]=y.useState(""),i={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},l=u=>{o(u),r(!0)},x=u=>{const d=u.target.value;(d===""||parseFloat(d)>=0)&&n(d)},g=u=>{u.preventDefault();const d=parseFloat(t);if(!d||isNaN(d)){w.error("Please enter a valid amount");return}if(d<2){w.error("Minimum donation amount is GH₵2");return}o(d),r(!0)},p=u=>{w.success(`Thank you for your donation of GH₵${u.amount}!`),r(!1),n(""),o(null)},h=()=>{r(!1),o(null)},b=()=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Complete Your Donation"}),e.jsx(I,{amount:a,onSuccess:p,onCancel:h})]})})}),v=[10,20,50,100];return y.useEffect(()=>{Y.pageview()},[]),e.jsxs("div",{className:"bg-overlayPrimary min-h-screen py-12 md:py-16",children:[e.jsxs("div",{className:"w-[90%] md:w-[80%] mx-auto",children:[e.jsxs("h1",{className:"headings font-bold mb-6 text-center text-white",children:["Make a ",e.jsx("span",{className:"text-darkYellow",children:"Donation"})]}),e.jsxs("h2",{className:"text-2xl font-semibold mb-8 text-center text-gray-300",children:["Fundraising ",e.jsx("span",{className:"text-darkYellow",children:"Categories"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 mb-12",children:[e.jsxs(j.div,{className:"bg-primary p-8 sm:p-6 rounded-md shadow-md w-[95%] mx-auto md:w-full",initial:"hidden",animate:"visible",variants:i,transition:{duration:.5},children:[e.jsx("img",{src:H,alt:"Buy Stationery",className:"w-full h-52 sm:h-48 object-cover rounded-sm mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-dark mb-2",children:"Donate Stationery"}),e.jsx("p",{className:"text-overlay mb-4",children:"Help us provide essential stationery for children."}),e.jsx("button",{onClick:()=>l(15),className:"w-full bg-dark text-white hover:bg-darkYellow hover:text-dark py-3 sm:py-2 px-4 rounded-lg transition duration-300",children:"Donate GH₵15"})]}),e.jsxs(j.div,{className:"bg-primary p-8 sm:p-6 rounded-md shadow-md w-[95%] mx-auto md:w-full",initial:"hidden",animate:"visible",variants:i,transition:{duration:.5},children:[e.jsx("img",{src:O,alt:"Donate Clothing",className:"w-full h-52 sm:h-48 object-cover rounded-sm mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-dark mb-2",children:"Donate Clothing"}),e.jsx("p",{className:"text-overlay mb-4",children:"Support our clothing drive for those in need."}),e.jsx("button",{onClick:()=>l(20),className:"w-full bg-dark hover:bg-darkYellow text-white hover:text-dark py-3 sm:py-2 px-4 rounded-lg transition duration-300",children:"Donate GH₵20"})]}),e.jsxs(j.div,{className:"bg-primary p-8 sm:p-6 rounded-md shadow-md w-[95%] mx-auto md:w-full",initial:"hidden",animate:"visible",variants:i,transition:{duration:.5},children:[e.jsx("img",{src:_,alt:"Donate Food",className:"w-full h-52 sm:h-48 object-cover rounded-sm mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-dark mb-2",children:"Donate Food"}),e.jsx("p",{className:"text-overlay mb-4",children:"Help us provide meals for families in need."}),e.jsx("button",{onClick:()=>l(20),className:"w-full bg-dark hover:bg-darkYellow text-white hover:text-dark py-3 sm:py-2 px-4 rounded-lg transition duration-300",children:"Donate GH₵20"})]})]}),e.jsxs("div",{className:"bg-darkShade shadow-lg rounded-lg p-6 md:p-8 max-w-2xl mx-auto mb-8",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-6 text-center text-white",children:["Suggested ",e.jsx("span",{className:"text-darkYellow",children:"Amounts"})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:v.map(u=>e.jsxs(j.button,{onClick:()=>l(u),className:`bg-dark text-white py-4 px-8 rounded-lg \r
									 hover:bg-darkYellow hover:text-dark \r
									 transition-colors text-lg font-semibold\r
									 min-w-[120px]`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:["GH₵",u]},u))})]}),e.jsxs("div",{className:"bg-darkShade shadow-lg rounded-lg p-8 max-w-2xl mx-auto",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-6 text-center text-primary",children:["Custom Donation ",e.jsx("span",{className:"text-darkYellow",children:"Amount"})]}),e.jsxs("form",{onSubmit:g,className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-full max-w-xs mb-4",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"GH₵"}),e.jsx("input",{type:"number",step:"any",value:t,onChange:x,placeholder:"Enter amount (min. GH₵2)",className:`w-full pl-12 pr-4 py-3 rounded-lg\r
										 focus:outline-none focus:ring-2 focus:ring-darkYellow \r
										 text-gray-900`})]}),e.jsx("button",{type:"submit",className:`w-full max-w-xs bg-darkYellow text-dark hover:bg-dark \r
									 hover:text-white py-3 px-4 rounded-lg \r
									 transition duration-300`,children:"Donate"})]})]})]}),s&&e.jsx(b,{})]})};export{D as default};
